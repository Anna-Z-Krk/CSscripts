// (c) Copyright 2013 Adobe Systems, Inc. All rights reserved.// author David Deraedt#include "../common/Utils.jsx"#include "LayerExporter.jsx"var EdgeAnimateExporter = (function () {	/**	Exports the given item array to a given EdgeAnimate project	The project's xxx_edge.js dom array will also be modified to properly place	each image onto the project's stage.	Warning: this script will modify the original an file	@public	@param {File} anFile The destination Edge Animate project file	@param {String} exportType Determines if layers should be converted to SVG or PNG files	@param {Array} itemsData Array of item objects as exported by LayerDataExtractor		(This value should use ExportType constants)	*/	function exportToAnimate(anFile, exportType, itemsData){				var destFolder = anFile.parent;				var anName = getFileNamePart(anFile.name);		var imgFolder = new Folder(destFolder.path +"/"+ destFolder.name + "/images/");		if(!imgFolder.exists) imgFolder.create();		var dest = imgFolder.absoluteURI+"/";		var outputTxt = "";				var n = itemsData.length;				for ( var j = n-1 ; j >= 0 ; j--){						var item = itemsData[j];									outputTxt += addItemData(item, exportType);					}						// edge animate code generation		//log("OUTPUT: " + outputTxt);		var edgeFile = new File(destFolder.absoluteURI+"/" + anName + "_edge.js");		var edgeFileString = getFileString(edgeFile.absoluteURI);			var newFileString = edgeFileString.replace("dom: [", "dom: [" + outputTxt);		saveTextFile(newFileString, edgeFile);			}	function addItemData(item, exportType){					var txt = "";				var ext = "svg";				if (exportType==ExportType.PNG24) ext = "png";				//var pos = getItemCoords(item);		//log('\nx: '+pos.x + ' , y: ' + pos.y);		txt += "\t\t{\n\t\t\tid:'" + item.name + "',\n";		txt += "\t\t\ttype:'image',\n";		txt += "\t\t\trect:[" + "'" + item.x + "', '" + item.y + "', '" + item.width + "px', '" + item.height + "px', " + "'auto','auto'],\n";		txt += "\t\t\tfill:[\"rgba(0,0,0,0)\",im+\"" + item.name + "." + ext +"\",'0px','0px'" + "]\n";		txt += "\t\t},\n";		return txt;			}	var obj = {};	obj.exportDoc = exportToAnimate;	return obj;	}());